import os
import pandas as pd

data = pd.read_csv("data/malware.csv")
data["class"] = data["class"].replace({"S": 0, "B": 1})

malware = data[data["class"] == 0]
benign = data[data["class"] == 1]


malware_train = malware[:5000]
malware_test = malware[5000:]

benign_train = benign[:8000]
benign_test = benign[8000:]

print(f"Malware train: {len(malware_train)}, Malware test: {len(malware_test)}")
print(f"Benign train: {len(benign_train)}, Benign test: {len(benign_test)}")

for i in range(10):
    mal = malware_train[i * 500 : (i + 1) * 500]
    ben = benign_train[i * 800 : (i + 1) * 800]
    os.makedirs(f"data/train_{i}", exist_ok=True)
    f = open(f"data/train_{i}/malware.csv", "x")
    f.write(mal.to_csv(index=False))
    f.write(ben.to_csv(index=False, header=False))
    f.close()

os.mkdir("data/test")
f = open("data/test/malware.csv", "x")
f.write(malware_test.to_csv(index=False))
f.write(benign_test.to_csv(index=False, header=False))
f.close()
