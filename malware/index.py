from src.train import train
from src.test import test
import sys
import argparse

"""
data
|__train/malware.csv
|__test/malware.csv
model
|__base
|    |__model.pth
|__model.pth
"""

parser = argparse.ArgumentParser()
parser.add_argument("round", type=int, help="Round number")
parser.add_argument(
    "--epoch", "-e", type=int, default=10, help="Number of epochs. Default: 10"
)
parser.add_argument(
    "--batch-size", "-b", type=int, default=64, help="Batch size. Default: 64"
)
parser.add_argument(
    "--learning-rate",
    "-lr",
    type=float,
    default=0.001,
    help="Learning rate. Default: 0.001",
)

args = parser.parse_args()

train_dir = f"data/train_{sys.argv[1] if len(sys.argv) > 1 else 0 }/malware.csv"
# or
# train_dir = "data/train/malware.csv"
test_dir = "data/test/malware.csv"
output = f"model/model_{sys.argv[1] if len(sys.argv) > 1 else 0 }.pth"
# or
# output = "model/model.pth"

train(train_dir, output, args.epoch, args.batch_size, args.learning_rate)
test(output, test_dir, args.batch_size)
